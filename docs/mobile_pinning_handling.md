# 移动端抓包抓不到（pinning/自研 TLS）处理路径（文档化）

本项目当前提供的“代理抓包 + Windows Native Hook”主要覆盖 **桌面应用**。移动端（iOS/Android）若出现证书固定（pinning）或自研 TLS，建议按“可复现/可定位/可关联”的思路分阶段处理，并优先使用 **合规、可控** 的方式完成采集。

---

## 1) 先保证可复现（代理侧能看到“域名/路径/时序”）

即使 HTTPS 无法解密，也尽量确认：

- 是否有请求产生（NO_TRAFFIC vs 有流量但失败）
- 目标域名/接口路径/请求频率/失败时序
- 是否可能走 HTTP/3(QUIC) / 直连 / VPN / 私有隧道

这些信息对后续定位“到底卡在代理、TLS、还是应用层加密”非常关键。

---

## 2) 首选：为“你拥有控制权的 App”提供 Debug 抓包通道（推荐）

如果目标 App 为自研或你有开发权限，优先在 **Debug/测试环境** 做以下改造（不建议在生产环境启用）：

- 提供“关闭证书固定 / 允许自签 CA / 允许代理”的 Debug 开关
- Android：使用 Network Security Config 的 debug overrides（允许用户证书）并确保目标网络库遵循系统信任链
- iOS：提供调试证书信任策略（或在调试构建中禁用/放宽 pinning）

这样可在不引入额外对抗工具的情况下，获得可解密、可关联的完整流量与 payload。

---

## 3) 若必须做运行时定位（仅限获得授权的测试/排障场景）

当你无法改造 App，但又需要定位 pinning/自研 TLS 的“发生点”，通常需要运行时观测能力（例如函数级调用链、关键 API 的输入输出特征等）。

本项目的原则建议：

- 先用代理抓到“外部特征”（域名/路径/时序）作为锚点
- 再在得到授权的前提下，引入移动端侧的可观测方案（工具形态与落地方式取决于平台与设备环境）
- 最终目标是定位到：证书校验点 / 加密点 / 压缩点 / 序列化点，并将相关事件与网络请求关联

安全与合规提醒：

- 仅在你拥有明确授权的设备与应用上进行测试
- 避免将相关能力用于绕过第三方安全策略或非法抓取数据

---

## 4) 本项目的落地边界

- 当前：移动端配置页会给出“抓不到/解密失败”的分诊建议与后端诊断信号。
- 未来（若确需支持移动端 Hook）：建议以“模板化 + 可选落盘 + 明确预算上限 + 强提示风险”的方式接入，并保持与 `analysis_bundle` 的数据结构一致（会话、索引、产物引用、关联键）。

