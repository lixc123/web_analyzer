# Web Analyzer V2 启动状态报告

## 启动时间
2026-01-21 19:00

## 服务状态

### ✅ 后端服务 (Backend)
- **状态**: 运行中
- **端口**: 8001 (原8000端口被占用，已修改)
- **地址**: http://localhost:8001
- **API文档**: http://localhost:8001/docs
- **健康检查**: http://localhost:8001/health ✅ 通过

### ✅ 前端服务 (Frontend)
- **状态**: 运行中
- **端口**: 3002 (原3000/3001端口被占用)
- **地址**: http://localhost:3002
- **开发服务器**: Vite v5.4.21

## 已修复的问题

### 1. 缺失依赖包
- ✅ 安装 `jsbeautifier` - JS代码美化工具
- ✅ 安装 `mitmproxy` 及相关依赖 - 代理服务器
- ✅ 安装 `qrcode[pil]` - 二维码生成
- ✅ 安装 `frida` 和 `frida-tools` - Native Hook工具

### 2. 依赖版本冲突
- ✅ 修复 `bcrypt` 版本冲突 (降级到 4.1.3)
- ⚠️ `h11` 版本冲突 (mitmproxy需要<=0.14, httpcore需要>=0.16) - 已使用0.14版本，暂时不影响运行

### 3. 端口占用问题
- ✅ 后端端口从8000改为8001
- ✅ 前端自动使用3002端口 (3000/3001被占用)
- ✅ 更新前端配置文件 `.env.development` 指向新的后端端口

### 4. 数据库表缺失
- ✅ 创建 `filter_rules` 表
- ✅ 创建数据库初始化脚本 `backend/init_db.py`

## 配置文件修改

### .env
```
BACKEND_PORT=8001  # 从8000改为8001
```

### frontend/.env.development
```
VITE_API_BASE_URL=http://localhost:8001  # 从8000改为8001
VITE_WS_BASE_URL=ws://localhost:8001     # 从8000改为8001
```

## 警告信息 (不影响运行)

### 1. bcrypt版本警告
```
WARNING - (trapped) error reading bcrypt version
AttributeError: module 'bcrypt' has no attribute '__about__'
```
- **影响**: 无，passlib可以正常工作
- **原因**: bcrypt 4.x版本移除了 `__about__` 属性

### 2. FastAPI事件处理器弃用警告
```
DeprecationWarning: on_event is deprecated, use lifespan event handlers instead
```
- **影响**: 无，功能正常
- **建议**: 后续可以迁移到新的lifespan事件处理器

### 3. 数据库加载规则警告
```
ERROR - 从数据库加载规则失败: no such table: filter_rules
```
- **状态**: 已修复，表已创建

## 如何访问

1. **前端界面**: 打开浏览器访问 http://localhost:3002
2. **后端API文档**: 打开浏览器访问 http://localhost:8001/docs
3. **健康检查**: curl http://localhost:8001/health

## 进程管理

### 查看运行中的进程
```bash
# 后端进程ID: 9
# 前端进程ID: 10
```

### 停止服务
在各自的终端窗口按 `Ctrl+C` 停止服务

## 下一步建议

1. ✅ 服务已正常启动，可以开始使用
2. 建议在浏览器中打开 http://localhost:3002 测试前端界面
3. 如需重启服务，可以使用项目根目录的 `start_all.bat` 脚本（需要先修改端口配置）
4. 考虑解决h11版本冲突问题（可能需要升级mitmproxy或降级httpcore）
